name: CI/CD Pipeline

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build App
        run: echo "Building..."

  test:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - name: Run Tests
        run: echo "Testing..."

  approval:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Wait for Manual Approval
        uses: trstringer/manual-approval@v1
        with:
          approvers: mohan, devops-lead      # GitHub usernames
          minimum-approvals: 1
          issue-title: "Approval required for production deploy"
          issue-body: "Approve this to continue deployment."
          exclude-workflow-initiator: false

  deploy:
    needs: approval
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Production
        run: echo "ðŸš€ Deploying to production..."
